<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kr.smhrd.mapper.PhotoMapper">


<select id="getCrawling" resultType="kr.smhrd.entity.Crawling" parameterType="kr.smhrd.entity.Criteria">
	<![CDATA[
	select
	cr_seq, cr_file, cr_url, cr_date, admin_id, cr_count
	from
	(
	select
	rownum rn, cr_seq, cr_file, cr_url, cr_date, admin_id, cr_count from crawling
	where rownum <= #{page} * #{perPageNum} and cr_seq > 0
	)
	where rn > (#{page} -1) * #{perPageNum}
		]]>
</select>


<resultMap type="kr.smhrd.entity.Photo" id="getPhoto">
	<id property="deep_seq" column="deep_seq" />
	<id property="up_seq" column="up_seq" />
	<id property="deep_date" column="deep_date" />
	<id property="deep_photo1" column="deep_photo1" />
	<id property="deep_photo2" column="deep_photo2" />
	<id property="deep_photo3" column="deep_photo3" />
	<id property="deep_photo4" column="deep_photo4" />
	<id property="deep_photo5" column="deep_photo5" />
	<id property="deep_photo6" column="deep_photo6" />
	<id property="deep_photo7" column="deep_photo7" />
	<id property="deep_photo8" column="deep_photo8" />
	<id property="deep_photo9" column="deep_photo9" />
	<id property="deep_photo10" column="deep_photo10" />
</resultMap>


<resultMap type="kr.smhrd.entity.Crawling" id="getCrawling">
	<id property="cr_seq" column="cr_seq" />
	<id property="cr_file" column="cr_file" />
	<id property="cr_url" column="cr_url" />
	<id property="cr_date" column="cr_date" />
	<id property="admin_id" column="admin_id" />
	<id property="cr_count" column="cr_count" />
</resultMap>


<resultMap type="kr.smhrd.entity.Jointable" id="joinTable">
	<collection property="Photo" resultMap="getPhoto" />
	<collection property="Crawling" resultMap="getCrawling" />
</resultMap>


<select id="joinTable" resultType="kr.smhrd.entity.Jointable">
	select * from deep a, crawling b
	where a.deep_photo1 = b.cr_url
</select>


</mapper>